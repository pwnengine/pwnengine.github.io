<!DOCTYPE html> <html lang="en"><head>
<title>Let's Hack a Parental Control App - How I Uncovered a Conspiracy</title>
<base href=".">
<meta name="pathname" content="let's-hack-a-parental-control-app-how-i-uncovered-a-conspiracy.html">
<meta name="description" content="index - Let's Hack a Parental Control App - How I Uncovered a Conspiracy">
<meta property="og:title" content="Let's Hack a Parental Control App - How I Uncovered a Conspiracy">
<meta property="og:description" content="index - Let's Hack a Parental Control App - How I Uncovered a Conspiracy">
<meta property="og:type" content="website">
<meta property="og:url" content="let's-hack-a-parental-control-app-how-i-uncovered-a-conspiracy.html">
<meta property="og:image" content="app:/18dee078c7b50900781bb2ee2a7921e418b2/home/pwn/Obsidian/index/Pasted image 20250722135454.png?1753217694042">
<meta charset="UTF-8"><meta property="og:site_name" content="index"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings allow-fold-lists show-indentation-guide show-properties" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="Let's_Hack_a_Parental_Control_App_-_How_I_Uncovered_a_Conspiracy_0">Let's Hack a Parental Control App - How I Uncovered a Conspiracy</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-h3"><h3 data-heading="Background" dir="auto" class="heading" id="Background_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Background</h3></div><div class="el-p"><p dir="auto">To start this out I'd like to say parental control apps aka spyware, are some of the most malicious applications to exist. These apps are poorly written and you should never trust them to secure you, or your children's data. Would you believe me if I told you apps such as this are rarely used for parental control/monitoring? It's true! The actually audience for these apps are jealous partners and stalkers. For that reason moving forward I'll be referring to such apps as stalkerware.<br>
<span alt="Pasted image 20250722135454.png" src="pasted-image-20250722135454.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250722135454.png" src="pasted-image-20250722135454.png" target="_self"></span></p></div><div class="el-h2"><h2 data-heading="Intro" dir="auto" class="heading" id="Intro_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Intro</h2></div><div class="el-p"><p dir="auto">I decided to target <a rel="noopener nofollow" class="external-link is-unresolved" href="https://phonsee.com" target="_self">https://phonsee.com</a> which after purchasing using a vulnerability to literally change the price turns out is just <a rel="noopener nofollow" class="external-link is-unresolved" href="https://eyeszy.com." target="_self">https://eyeszy.com.</a> Funny enough, these companies and <a rel="noopener nofollow" class="external-link is-unresolved" href="https://parentaler.com" target="_self">https://parentaler.com</a> (which is seen referenced in the page source) are all subsidiaries of <strong><mark>Fortunex Limited</mark></strong>. This company seems to be part of some conspiracy that has a monopoly over the entire stalkerware market.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250722140611.png" src="pasted-image-20250722140611.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250722140611.png" src="pasted-image-20250722140611.png" target="_self"></span></p></div><div class="el-h2"><h2 data-heading="Testing Security" dir="auto" class="heading" id="Testing_Security_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Testing Security</h2></div><div class="el-p"><p dir="auto">First, let's get access to something other than their landing page. This was extremely easy since Phonsee is vulnerable to IDOR. I was able to purchase a license for just <em>69</em> cents.. nice...<br>
<span alt="Pasted image 20250722141339.png" src="pasted-image-20250722141339.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250722141339.png" src="pasted-image-20250722141339.png" target="_self"></span><br>
<span alt="Pasted image 20250727124836.png" src="pasted-image-20250727124836.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250727124836.png" src="pasted-image-20250727124836.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">We can send a POST request with a <code>discount</code> of up to 99 to endpoint <code>/backend/get-checkout</code> and the server validates it. Then we can actually purchase it and well...</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250722142350.png" src="pasted-image-20250722142350.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250722142350.png" src="pasted-image-20250722142350.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">We have an Eyezy account with premium. If you remember from earlier these are are the same companies. The first thing I did was explore the dashboard and try to setup a device to monitor. I selected IOS and downloaded the <code>Eyezy_setup.exe</code> to a virtual machine to examine. In Ghidra I can see just from searching through the strings it's indeed an installation wizard which will install to the C drive. Confirming this I install the application and see it a new directory <code>Eyezy</code> in my C drive.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250722143114.png" src="pasted-image-20250722143114.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250722143114.png" src="pasted-image-20250722143114.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Visually I can tell it's a C# application right away. This means reversal will be simple with <code>Dnspy</code>.  The first thing that draws my attention are api keys:</p></div><div class="el-pre"><pre><code data-line="0">if&nbsp;(this.AppState.AppBrand.ToLower()&nbsp;==&nbsp;"eyezy") {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  this.AppState.AmplitudeApiKey&nbsp;=&nbsp;"2872c418988f2edc2172b32287a8c649";&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  return;&nbsp;&nbsp;&nbsp;&nbsp;
}&nbsp;&nbsp;&nbsp;
if&nbsp;(this.AppState.AppBrand.ToLower()&nbsp;==&nbsp;"mstar")&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  this.AppState.AmplitudeApiKey&nbsp;=&nbsp;"9902da5576bd7f81dfcd05dcce8c21d9";&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  return;&nbsp;&nbsp;&nbsp;&nbsp;
}&nbsp;&nbsp;&nbsp;&nbsp;
if&nbsp;(this.AppState.AppBrand.ToLower()&nbsp;==&nbsp;"spynger")&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  this.AppState.AmplitudeApiKey&nbsp;=&nbsp;"5fc821f6238efa3bd223e282420ccb7";&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  return;&nbsp;&nbsp;&nbsp;&nbsp;
}&nbsp;&nbsp;&nbsp;&nbsp;
this.AppState.AmplitudeApiKey&nbsp;=&nbsp;"9b29e1e272040be0053b1a0af59319cf";
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">These are for analytics and have no value without the additional private key. The reason I'm showing this is because it seems <a rel="noopener nofollow" class="external-link is-unresolved" href="https://mspy.mobi" target="_self">https://mspy.mobi</a> and <a rel="noopener nofollow" class="external-link is-unresolved" href="https://spynger.net" target="_self">https://spynger.net</a> are both in the conspiracy. At this point I believe every parental monitoring app is just run by the same people. Actually, <mark>Spynger</mark> is completely advertised as stalkerware. They're site says it's <em>"Your Best Tool to Catch a Cheater"</em>.</p></div><div class="el-p"><p dir="auto">Anyway, I found some endpoints while reverse engineering it: </p></div><div class="el-pre"><pre><code data-line="0">/api/v1/dc/sync/{0}/action-log
/api/v1/auth/login
/api/v1/auth/refresh-token
/api/v1/auth/logout
/api/v1/dc/win-client-version-latest
/api/v1/dc/win-client-version-latest/download
/api/v1/dc/osx-client-version-latest
/api/v1/dc/osx-client-version-latest/download
/api/v1/dc/sync/{0}/sensor-configs
/api/v1/dc/sync/{0}/configs
/api/v1/dc/desktop-log/upload
/api/v1/dc/sync/{0}/add-device
/api/v1/dc/device/{0}
/api/v1/dc/sync/{0}/unlink-device
/api/v1/dc/sync/{0}/unlink
/api/v1/dc/device/{0}/init-backup
/api/v1/dc/device/{0}/sensor-backups
/api/v1/dc/sensor-backup/{0}/upload
/api/v1/dc/sync
/api/v1/dc/customer/syncs
/api/v1/customer/subscriptions
/api/doc
/api/health-check/liveness
/api/health-check/readiness
/api/v1/slots/{0}/upload/start
/api/v1/slots/{0}/upload/complete
/api/v1/slots/{0}/sensors/data
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Next, I'd like to see the requests in action. To do this I'm going to route all the VMs traffic through burp proxy by listing on my host linux box and configuring it in Window's VM manual proxy settings.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250722223417.png" src="pasted-image-20250722223417.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250722223417.png" src="pasted-image-20250722223417.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">There we go! The requests are being intercepted by burpsuite. Looking through them I can see they're matching what was expected from reversing the application. None of this looks very interesting to me...</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250722223551.png" src="pasted-image-20250722223551.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250722223551.png" src="pasted-image-20250722223551.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Oh look, another bug of course. I took a peek at the <code>/api/v1/auth/refresh-token</code> POST request, which takes a refresh token as <code>refreshToken</code> in the body of the request and notice I could send the request multiple times and still get a new JWT &amp; refresh token returned back.</p></div><div class="el-h4"><h4 data-heading="REQUEST 1:" dir="auto" class="heading" id="REQUEST_1_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>REQUEST 1:</h4></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250727124736.png" src="pasted-image-20250727124736.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250727124736.png" src="pasted-image-20250727124736.png" target="_self"></span></p></div><div class="el-h4"><h4 data-heading="REQUEST 2:" dir="auto" class="heading" id="REQUEST_2_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>REQUEST 2:</h4></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250727124753.png" src="pasted-image-20250727124753.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250727124753.png" src="pasted-image-20250727124753.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Now we're looking at a Refresh Token Reuse Vulnerability. If an attacker obtains a refresh token, they can repeatedly use it to generate new JWTs, potentially gaining persistent access to the user’s account. I think it's safe to say security wasn't a top priority for the developer. I'm assuming more can be found, but I can't trigger any more requests to intercept without plugging in my phone (which I don't want to do for obvious reasons). I'll have to reverse the app deeper to see how the other endpoints are hit.</p></div><div class="el-p"><p dir="auto">I will be making a part two which will include a deeper analysis on the app itself to see exactly what it's doing behind the scenes. If you get anything out of reading this it should be these stalkerware applications do not have your security in mind and should never be trusted.</p></div><div class="el-h2"><h2 data-heading="Part Two" dir="auto" class="heading" id="Part_Two_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Part Two</h2></div><div class="el-p"><p dir="auto">First I want to see the core functionality of how the requests are made and to do this I'll use dotPeek which will let me export the decompiled app into a Visual Studio project for easier analysis.<br>
<span alt="Pasted image 20250726165636.png" src="pasted-image-20250726165636.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250726165636.png" src="pasted-image-20250726165636.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">I created a reversed app that mimicked all the requests and played with them to see if anything interesting could be done. To make a long story short, a JWT had to be send with every request for the server to validate it and there aren't any secret keys of any sort. At this point I decided to take my attention off the desktop application and focus on the mobile one. I setup burpsuite proxy on my phone and started intercepting. Not to my surprise it's using Firebase, which is a popular Database as a Service (DBaaS) for mobile and web applications.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250726170112.png" src="pasted-image-20250726170112.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250726170112.png" src="pasted-image-20250726170112.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">A common technique to use against applications using Firebase is to check for a misconfiguration in rules that could let a threat actor read/write. For this I'll need to download the apk for analysis using <a rel="noopener nofollow" class="external-link is-unresolved" href="https://apkpure.com." target="_self">https://apkpure.com.</a> There's a great python tool for this called apkscan which will try to leak all secrets from the apk. You can clone it from github here <a rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/LucasFaudman/apkscan" target="_self">https://github.com/LucasFaudman/apkscan</a>. Keep in mind it won't work with python 3.13 because it's importing <code>re.TEMPLATE</code> which is depreciated. I created a pull request removing the import, hopefully it gets accepted. If you want to use python 3.13 you'll need to remove line 7 of <code>secret_scanner.py</code>, or clone from my fork <a rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/pwnengine/apkscan" target="_self">https://github.com/pwnengine/apkscan</a>. I was not able to retrieve any secrets, but it's still a good tool to have in the arsenal. My attention was then directed to <code>/v2/parent/accounts</code> which responds with all monitored devices data associated with the <code>authToken</code>. This token is a not a standard JWT and has no session binding. It's 32 bits and could be another point of interest considering burp's sequencer found the entropy to be poor. </p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250727000948.png" src="pasted-image-20250727000948.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250727000948.png" src="pasted-image-20250727000948.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Here's the problem, I wanted to check to see if tokens could be reused after another is issued and send this request with an empty <code>deviceToken</code> which crashed the server. Now, the app is completely unusable and I can't do much else. On the plus side this means there's a Denial of Service vulnerability here.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250727001002.png" src="pasted-image-20250727001002.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250727001002.png" src="pasted-image-20250727001002.png" target="_self"></span><br>
<span alt="Pasted image 20250727001601.png" src="pasted-image-20250727001601.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20250727001601.png" src="pasted-image-20250727001601.png" target="_self"></span></p></div><div class="el-h2"><h2 data-heading="Part Three" dir="auto" class="heading" id="Part_Three_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Part Three</h2></div><div class="el-p"><p dir="auto">It's the next day and the api still returns a 502. I'm assuming that sending the request to <code>/v2/parent/login</code> without an empty <code>deviceToken</code> field caused an exception that was uncaught. So, we successfully took down the stalkerware. This wasn't how I wanted to end this, but that's all I got so far. Never use these stalkerware applications!</p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="let's-hack-a-parental-control-app-how-i-uncovered-a-conspiracy.html#Let's_Hack_a_Parental_Control_App_-_How_I_Uncovered_a_Conspiracy_0" data-path="#Let's_Hack_a_Parental_Control_App_-_How_I_Uncovered_a_Conspiracy_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Let's Hack a Parental Control App - How I Uncovered a Conspiracy">Let's Hack a Parental Control App - How I Uncovered a Conspiracy</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="let's-hack-a-parental-control-app-how-i-uncovered-a-conspiracy.html#Background_0" data-path="#Background_0"><div class="tree-item-inner heading-link" heading-name="Background">Background</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="let's-hack-a-parental-control-app-how-i-uncovered-a-conspiracy.html#Intro_0" data-path="#Intro_0"><div class="tree-item-inner heading-link" heading-name="Intro">Intro</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="let's-hack-a-parental-control-app-how-i-uncovered-a-conspiracy.html#Testing_Security_0" data-path="#Testing_Security_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Testing Security">Testing Security</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="let's-hack-a-parental-control-app-how-i-uncovered-a-conspiracy.html#REQUEST_1_0" data-path="#REQUEST_1_0"><div class="tree-item-inner heading-link" heading-name="REQUEST 1:">REQUEST 1:</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="let's-hack-a-parental-control-app-how-i-uncovered-a-conspiracy.html#REQUEST_2_0" data-path="#REQUEST_2_0"><div class="tree-item-inner heading-link" heading-name="REQUEST 2:">REQUEST 2:</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="let's-hack-a-parental-control-app-how-i-uncovered-a-conspiracy.html#Part_Two_0" data-path="#Part_Two_0"><div class="tree-item-inner heading-link" heading-name="Part Two">Part Two</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="let's-hack-a-parental-control-app-how-i-uncovered-a-conspiracy.html#Part_Three_0" data-path="#Part_Three_0"><div class="tree-item-inner heading-link" heading-name="Part Three">Part Three</div></a><div class="tree-item-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>